---
- name: SOPHOS FIREWALL ANSIBLE MODULE TESTING
  hosts: all
  gather_facts: false

  tasks:
    - name: Create syslog server, all logging enabled
      sophos.sophos_firewall.sfos_syslog:
        username: "{{ username }}"
        password: "{{ password }}"
        hostname: "{{ inventory_hostname }}"
        port: 4444
        verify: false
        name: TestSyslog
        address: 10.10.1.100
        udp_port: 514
        secure_connection: Disable
        facility: DAEMON
        severity: Emergency
        format: Device standard
        default_logging: Enable
        state: present
      delegate_to: localhost

    - name: Update syslog server with some logging disable
      sophos.sophos_firewall.sfos_syslog:
        username: "{{ username }}"
        password: "{{ password }}"
        hostname: "{{ inventory_hostname }}"
        port: 4444
        verify: false
        name: TestSyslog
        address: 10.10.1.100
        udp_port: 514
        secure_connection: Disable
        facility: DAEMON
        severity: Emergency
        format: Device standard
        default_logging: Enable
        log_settings:
          security_policy:
            bridge_acls: Enable
            dos_attack: Enable
            dropped_fragment: Enable
            dropped_icmpredirect: Enable
            dropped_sourceroute: Enable
            heartbeat: Enable
            icmp_errormessage: Enable
            invalid_traffic: Enable
            ipmacpair_filtering: Enable
            ipspoof_prevention: Enable
            local_acls: Enable
            mac_filtering: Enable
            policy_rules: Enable
            protected_application_server: Enable
            ssl_vpntunnel: Enable
          system_health:
            usage: Enable
          web_server_protection:
            waf_events: Enable
          wireless:
            access_points_ssid: Enable
          zeroday_protection:
            zeroday_protection_events: Enable
          content_filtering:
            application_filter: Enable
            ssl_tls: Enable
            web_content_policy: Enable
            web_filter: Enable
          atp:
            atp_events: Enable
          anti_spam:
            imap: Enable
            imaps: Enable
            pop3: Enable
            pops: Enable
            smtps: Enable
          anti_virus:
            ftp: Enable
            http: Enable
            https: Enable
            imap: Enable
            imaps: Enable
            pop3: Enable
            pops: Enable
            smtp: Enable
            smtps: Enable
          events:
            admin: Enable
            authentication: Enable
            system: Enable
          heartbeat:
            endpoint_status: Enable
          ips:
            anomaly: Enable
            signatures: Enable
          sdwan:
            profile: Enable
            route: Enable
            sla: Enable
        state: updated
      delegate_to: localhost